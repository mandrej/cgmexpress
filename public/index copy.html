<!DOCTYPE html>
<html>
<head>
  <title>TEST</title>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter2/1.5.4/crossfilter.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.7/dc.min.js"></script>
  <link rel="stylesheet" src="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.7/style/dc.min.css"></link> -->
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.0/dc.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.0/dc.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>TEST</h1>
  <div id="line-chart"></div>
  <script>
    d3.json('/api/data').then(function(data) {
      const ndx = crossfilter(data);
      const dateDimension = ndx.dimension(d => d.date);
      const vailueDimension = ndx.dimension(d => d.value);
      const dateGroup = dateDimension.group().reduceSum(function(d) {
          return d.value;
      });

      // const chart = dc.barChart('#chart');
      // chart
      //   .dimension(dateDimension)
      //   // .group(categoryGroup)
      //   .x(d3.scaleBand())
      //   .xUnits(dc.units.ordinal)
      //   .elasticY(true);
      const lineChart = dc.lineChart('#line-chart');

      lineChart
        .width(800)
        .height(400)
        .x(d3.scaleTime().domain([new Date(2025, 9, 26, 0, 0, 0), new Date(2025, 9, 27, 0, 0, 0)]))
        .y(d3.scaleLinear().domain([40, 9]))
        .xAxisLabel('Time')
        .yAxisLabel('Value')
        .xAxisPadding(0.5)
        .xUnits(d3.scaleTime)
        .dimension(dateDimension)
        .dimension(vailueDimension)
        .group(dateGroup)
        .renderArea();

      dc.renderAll();
    });
  </script>
</body>
</html>